# TextCNN和TextRank情感分析实验报告

## 实验概述

本实验在中药材电商评论数据集上对比了多种情感分析算法的性能，重点测试了TextCNN和TextRank情感分析方法。

## 数据集信息

- **总评论数**: 234,880条
- **数据分布**:
  - 好评: 178,014条 (75.8%)
  - 中评: 27,023条 (11.5%)
  - 差评: 29,843条 (12.7%)
- **文件数量**: 755个Excel文件

## 算法性能对比

### 1. 整体性能排名

| 算法 | 准确率 | 精确率 | 召回率 | F1值 |
|------|--------|--------|--------|------|
| **TextCNN** | **84.40%** | **83.66%** | **84.40%** | **83.95%** |
| 朴素贝叶斯 | 76.77% | 74.97% | 76.77% | 68.30% |
| SVM | 76.25% | 71.09% | 76.25% | 68.26% |
| TextRank | 75.03% | 62.56% | 75.03% | 66.69% |
| 词典方法 | 56.48% | 81.52% | 56.48% | 61.26% |

### 2. TextCNN模型详细结果

#### 训练过程
- **训练集**: 12,800条样本
- **验证集**: 3,200条样本  
- **测试集**: 4,000条样本
- **词汇表大小**: 10,000
- **训练轮数**: 10 epochs

#### 训练曲线
- **最终训练准确率**: 95.38%
- **最终验证准确率**: 85.19%
- **测试准确率**: 84.40%

#### 分类详细结果
```
              precision    recall  f1-score   support
          -1       0.61      0.64      0.62       510
           0       0.53      0.42      0.47       472
           1       0.92      0.95      0.93      3018
    accuracy                           0.84      4000
   macro avg       0.69      0.67      0.67      4000
weighted avg       0.84      0.84      0.84      4000
```

### 3. TextRank情感分析详细结果

#### 方法特点
- **特征提取**: 使用TextRank算法提取前100个关键词作为特征
- **分类器**: 基于TextRank特征的SVM模型
- **训练集**: 16,000条样本
- **测试集**: 4,000条样本

#### 分类详细结果
```
              precision    recall  f1-score   support
          -1       0.15      0.04      0.06       475
           0       0.15      0.00      0.01       464
           1       0.77      0.97      0.86      3061
    accuracy                           0.75      4000
   macro avg       0.36      0.34      0.31      4000
weighted avg       0.63      0.75      0.67      4000
```

## 关键发现

### 1. TextCNN优势
- **最高准确率**: 84.40%，显著优于其他方法
- **均衡性能**: 在准确率、精确率、召回率和F1值上都表现最佳
- **好评识别**: 对好评的识别效果极佳（精确率92%，召回率95%）
- **深度学习优势**: 能够自动学习文本的深层特征表示

### 2. TextRank局限性
- **特征维度限制**: 仅使用100个关键词特征，信息量有限
- **类别不平衡敏感**: 对中评和差评的识别效果较差
- **传统方法局限**: 基于图算法的关键词提取无法捕捉复杂的语义关系

### 3. 数据集特点影响
- **类别不平衡**: 好评占比75.8%，导致模型偏向于预测好评
- **TextCNN适应性**: 深度学习方法在不平衡数据上表现更稳定
- **传统方法局限**: 词典和机器学习方法受数据分布影响较大

## 结论与建议

### 1. 最佳模型选择
**TextCNN是本实验中表现最佳的情感分析模型**，建议在中药材电商评论分析中优先使用。

### 2. 模型优化建议
- **数据平衡**: 使用过采样或欠采样技术平衡数据集
- **特征工程**: 结合TextRank关键词特征和深度学习特征
- **模型集成**: 将TextCNN与传统方法结合，提升整体性能

### 3. 实际应用价值
- **准确率高**: TextCNN的84.40%准确率满足实际业务需求
- **实时性**: 训练完成后推理速度快，适合实际部署
- **可解释性**: 可通过注意力机制分析模型关注的关键词

### 4. 未来改进方向
- **预训练模型**: 尝试BERT等预训练语言模型
- **多任务学习**: 同时进行情感分析和关键词提取
- **领域适应**: 针对中药材领域进行模型微调

## 技术细节

### TextCNN模型架构
- **嵌入层**: 词向量维度为100
- **卷积层**: 多个不同尺寸的卷积核(3,4,5)
- **池化层**: 最大池化
- **全连接层**: 分类输出层
- **优化器**: Adam优化器
- **学习率**: 0.001

### TextRank算法参数
- **关键词数量**: 100个
- **图构建**: 基于词共现关系
- **迭代次数**: 默认收敛条件
- **分类器**: 线性SVM

---

*实验时间: 2025年7月29日*  
*数据集: 中药材电商评论数据*  
*实验环境: Python 3.12, PyTorch 2.7.1* 